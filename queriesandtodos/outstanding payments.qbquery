select members.id,members.username,accounts.account_number,schemes.scheme,accounts.id,max(transactions.timestamp) from accounts inner join schemes on accounts.scheme_id =schemes.id  inner join members on accounts.member_id = members.id inner join transactions on accounts.id = transactions.account_id  where accounts.closed=0 and (schemes.scheme='Long Term Loan' or schemes.scheme='Short Term Loan' or schemes.scheme='MDS Loan' or schemes.scheme='HP Loan' or schemes.scheme='Pay Security Loan' or schemes.scheme='mds' ) and transactions.`timestamp`<DATE_SUB(NOW(),INTERVAL 1 MONTH) group by accounts.id